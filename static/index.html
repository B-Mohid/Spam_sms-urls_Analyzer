<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spam Classifier AI</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        /* Custom Styles for the Futuristic Look */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0a0a0a; /* Off-black for depth */
        }

        .font-orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        /* Glassmorphism and Neon Glow Effect */
        .glass-pane {
            background: rgba(20, 20, 22, 0.6); /* Semi-transparent dark background */
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(110, 227, 255, 0.2);
        }
        
        .neon-glow-cyan {
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.4), 
                        0 0 10px rgba(0, 255, 255, 0.3), 
                        0 0 20px rgba(0, 255, 255, 0.2);
        }

        .neon-glow-pink {
            box-shadow: 0 0 5px rgba(255, 0, 150, 0.4), 
                        0 0 10px rgba(255, 0, 150, 0.3), 
                        0 0 20px rgba(255, 0, 150, 0.2);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #111;
        }
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 255, 255, 0.5);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 255, 255, 0.8);
        }

        /* Custom Radio Buttons */
        .radio-label input[type="radio"] {
            display: none;
        }
        .radio-label span {
            padding: 8px 16px;
            border: 1px solid rgba(0, 255, 255, 0.4);
            border-radius: 9999px;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            color: rgba(0, 255, 255, 0.7);
        }
        .radio-label input[type="radio"]:checked + span {
            background: rgba(0, 255, 255, 0.9);
            color: #0a0a0a;
            font-weight: 500;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }

        /* Result gauge animation */
        .gauge-dial {
            transition: transform 1s cubic-bezier(0.25, 1, 0.5, 1);
        }
        
        /* Loading Spinner */
        .loader {
            border: 4px solid #f3f3f330;
            border-top: 4px solid #00ffff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

    </style>
</head>

<body class="text-gray-200">

    <!-- Main Container -->
    <div class="min-h-screen w-full flex flex-col items-center justify-center p-4 bg-cover bg-center" style="background-image: url('https://placehold.co/1920x1080/0a0a0a/1E1E1E?text=.')">

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="absolute inset-0 bg-black bg-opacity-80 flex flex-col items-center justify-center z-50 transition-opacity duration-500">
            <div class="loader"></div>
            <p id="loading-status" class="mt-4 font-orbitron text-cyan-300">INITIALIZING AI CORE...</p>
        </div>

        <main id="main-content" class="w-full max-w-4xl mx-auto opacity-0 transition-opacity duration-500">
            
            <header class="text-center mb-8">
                <h1 class="font-orbitron text-4xl md:text-5xl font-bold text-white tracking-wider">
                    <span class="text-cyan-300">SPAM</span>CLASSIFIER <span class="text-pink-400">AI</span>
                </h1>
                <p class="text-cyan-200 opacity-80 mt-2">Client-Side Threat Analysis Engine</p>
            </header>

            <div class="glass-pane rounded-2xl p-6 md:p-8">
                <!-- Tabs -->
                <div class="flex border-b border-cyan-300/20 mb-6">
                    <button class="tab-btn active px-4 py-2 text-cyan-300 border-b-2 border-cyan-300 font-orbitron" onclick="showTab('analyzer')">ANALYZER</button>
                    <button class="tab-btn px-4 py-2 text-gray-400" onclick="showTab('about')">ABOUT</button>
                    <button class="tab-btn px-4 py-2 text-gray-400" onclick="showTab('addToDevice')">ADD TO DEVICE</button>
                </div>

                <!-- Analyzer Tab -->
                <div id="analyzer" class="tab-content">
                    <!-- Model Selection -->
                    <div class="flex justify-center space-x-4 mb-6">
                        <label class="radio-label">
                            <input type="radio" name="modelType" value="sms" checked onchange="updateUIForModel()">
                            <span>Analyze SMS</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="modelType" value="url">
                            <span>Analyze URL</span>
                        </label>
                    </div>

                    <!-- Input Area -->
                    <div class="relative mb-4">
                        <textarea id="text-input" class="w-full h-32 p-4 bg-black/30 border border-cyan-300/30 rounded-lg focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 outline-none transition duration-200 resize-none" placeholder="Enter SMS message to analyze..."></textarea>
                    </div>
                    
                    <div class="flex flex-col md:flex-row items-center gap-4">
                        <button id="analyze-btn" class="w-full md:w-auto bg-cyan-500 hover:bg-cyan-400 disabled:bg-gray-600 disabled:cursor-not-allowed text-black font-orbitron font-bold py-3 px-8 rounded-full transition-all duration-300 neon-glow-cyan">
                            ANALYZE
                        </button>
                        <button id="clear-btn" class="w-full md:w-auto bg-pink-500/80 hover:bg-pink-500 text-black font-orbitron font-bold py-3 px-8 rounded-full transition-all duration-300 neon-glow-pink">
                            CLEAR
                        </button>
                    </div>

                    <!-- Results Section -->
                    <div id="result-section" class="mt-8 p-6 border border-cyan-300/30 rounded-lg bg-black/20 text-center" style="display: none;">
                        <h2 class="font-orbitron text-xl mb-4 text-white">Analysis Result</h2>
                        <div class="relative w-48 h-24 mx-auto mb-4">
                            <svg class="w-full h-full" viewBox="0 0 100 50">
                                <path d="M 10 50 A 40 40 0 0 1 90 50" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="8" stroke-linecap="round"/>
                                <path id="gauge-arc" d="M 10 50 A 40 40 0 0 1 90 50" fill="none" stroke="#E5E7EB" stroke-width="8" stroke-linecap="round" stroke-dasharray="125.6" stroke-dashoffset="125.6" style="transition: stroke-dashoffset 1s ease-out, stroke 1s ease-out;"/>
                                <path id="gauge-dial" class="gauge-dial" d="M 50 50 L 50 10" stroke="#fff" stroke-width="2" stroke-linecap="round" style="transform-origin: 50px 50px; transform: rotate(-90deg)"/>
                            </svg>
                            <div class="absolute inset-0 flex items-end justify-center">
                                <span id="result-percentage" class="font-orbitron text-3xl">0%</span>
                            </div>
                        </div>
                        <p id="result-text" class="text-2xl font-bold"></p>
                        <p id="result-comment" class="text-gray-400 mt-1"></p>
                    </div>
                </div>

                <!-- About Tab -->
                <div id="about" class="tab-content hidden prose prose-invert prose-p:text-gray-300 prose-headings:text-cyan-300 prose-headings:font-orbitron max-w-full">
                    <h2>About Spam Classifier AI</h2>
                    <p>This application leverages the power of machine learning, directly in your browser, to protect you from potential threats in SMS messages and URLs. By using two distinct, expertly trained models, it provides specialized analysis for different types of content.</p>
                    <h4>Key Technologies</h4>
                    <ul>
                        <li><strong>TensorFlow.js:</strong> Enables running machine learning models entirely on the client-side, ensuring your data never leaves your device.</li>
                        <li><strong>Dual-Model Architecture:</strong> An SMS model trained on word indices and a URL model trained on character indices provide high-accuracy, context-aware predictions.</li>
                        <li><strong>Futuristic Interface:</strong> Built with Tailwind CSS for a responsive, modern, and engaging user experience.</li>
                    </ul>
                    <p>This project demonstrates a privacy-first approach to AI-powered security tools.</p>
                </div>
                
                <!-- Add to Device Tab -->
                <div id="addToDevice" class="tab-content hidden prose prose-invert prose-p:text-gray-300 prose-headings:text-cyan-300 prose-headings:font-orbitron max-w-full">
                    <h2>Add to Your Device</h2>
                    <p>You can add this web application to your home screen for quick access, just like a native app.</p>
                    <h4>For iOS (Safari)</h4>
                    <ol>
                        <li>Tap the "Share" button at the bottom of the screen.</li>
                        <li>Scroll down and tap on "Add to Home Screen".</li>
                        <li>Confirm the name and tap "Add".</li>
                    </ol>
                    <h4>For Android (Chrome)</h4>
                    <ol>
                        <li>Tap the three-dot menu icon in the top-right corner.</li>
                        <li>Tap on "Install app" or "Add to Home screen".</li>
                        <li>Follow the on-screen instructions to install.</li>
                    </ol>
                    <p>Now you have a one-tap shortcut to the Spam Classifier AI, ready to protect you anytime.</p>
                </div>
            </div>
            
            <footer class="text-center mt-8 text-gray-500 text-sm">
                <p>Engineered for Privacy & Performance. &copy; 2025.</p>
            </footer>

        </main>
    </div>
    
    <script>
        // --- CONSTANTS AND STATE ---
        const UI = {
            loadingOverlay: document.getElementById('loading-overlay'),
            loadingStatus: document.getElementById('loading-status'),
            mainContent: document.getElementById('main-content'),
            analyzeBtn: document.getElementById('analyze-btn'),
            clearBtn: document.getElementById('clear-btn'),
            textInput: document.getElementById('text-input'),
            resultSection: document.getElementById('result-section'),
            resultText: document.getElementById('result-text'),
            resultPercentage: document.getElementById('result-percentage'),
            resultComment: document.getElementById('result-comment'),
            gaugeArc: document.getElementById('gauge-arc'),
            gaugeDial: document.getElementById('gauge-dial'),
            tabs: document.querySelectorAll('.tab-btn'),
            tabContents: document.querySelectorAll('.tab-content'),
        };

        // --- IMPORTANT: MODEL PATHS ---
        // CORRECTED: Paths now point to a 'models' subdirectory.
        // You MUST create a 'models' folder next to this HTML file and place your model assets inside it.
        const MODELS = {
            sms: {
                model: null,
                index: null,
                modelPath: 'models/sms_model.json',
                indexPath: 'models/sms_word_index.json',
                maxLength: 150, // Typical max length for SMS
                placeholder: 'Enter SMS message to analyze...'
            },
            url: {
                model: null,
                index: null,
                modelPath: 'models/url_model.json',
                indexPath: 'models/url_char_index.json',
                maxLength: 200, // Typical max length for URLs
                placeholder: 'Enter URL to analyze...'
            }
        };

        // --- UI & TAB MANAGEMENT ---
        function showTab(tabName) {
            UI.tabContents.forEach(content => content.classList.add('hidden'));
            document.getElementById(tabName).classList.remove('hidden');
            
            UI.tabs.forEach(tab => tab.classList.remove('active', 'text-cyan-300', 'border-cyan-300'));
            UI.tabs.forEach(tab => {
                if (tab.getAttribute('onclick').includes(tabName)) {
                    tab.classList.add('active', 'text-cyan-300', 'border-cyan-300');
                } else {
                    tab.classList.remove('active', 'text-cyan-300', 'border-cyan-300');
                    tab.classList.add('text-gray-400');
                }
            });
        }
        
        function updateUIForModel() {
            const selectedModel = document.querySelector('input[name="modelType"]:checked').value;
            UI.textInput.placeholder = MODELS[selectedModel].placeholder;
            clearResult();
        }

        function displayResult(prediction) {
            const isSpam = prediction > 0.5;
            const percentage = Math.round(prediction * 100);
            
            const selectedModel = document.querySelector('input[name="modelType"]:checked').value;
            const isSms = selectedModel === 'sms';

            UI.resultSection.style.display = 'block';
            UI.resultPercentage.textContent = `${percentage}%`;
            
            // Gauge animation
            const arcLength = 125.6; // Circumference of the semi-circle
            const dashOffset = arcLength * (1 - prediction);
            UI.gaugeArc.style.strokeDashoffset = dashOffset;
            const dialRotation = -90 + (prediction * 180);
            UI.gaugeDial.style.transform = `rotate(${dialRotation}deg)`;

            if (isSpam) {
                UI.resultText.textContent = isSms ? 'Spam Detected' : 'Malicious URL Detected';
                UI.resultText.className = 'text-2xl font-bold text-red-400';
                UI.resultComment.textContent = 'High probability of being unsafe. Proceed with caution.';
                UI.gaugeArc.style.stroke = '#F87171'; // red-400
            } else {
                UI.resultText.textContent = isSms ? 'Looks Safe' : 'URL Seems Safe';
                UI.resultText.className = 'text-2xl font-bold text-green-400';
                UI.resultComment.textContent = 'Low probability of being unsafe. Still, always be careful.';
                UI.gaugeArc.style.stroke = '#4ADE80'; // green-400
            }
        }
        
        function clearResult() {
            UI.textInput.value = '';
            UI.resultSection.style.display = 'none';
        }

        // --- MODEL LOADING & PREPROCESSING ---
        async function loadResource(path, type = 'json') {
            try {
                const response = await fetch(path);
                if (!response.ok) throw new Error(`Failed to load ${path}: ${response.statusText}`);
                return type === 'json' ? await response.json() : response;
            } catch (error) {
                console.error(error);
                UI.loadingStatus.textContent = `ERROR: Could not load resource at '${path}'. Please check file path and ensure the model files exist.`;
                UI.loadingStatus.classList.add('text-red-500');
                return null;
            }
        }

        async function initialize() {
            UI.analyzeBtn.disabled = true;
            
            try {
                UI.loadingStatus.textContent = 'Loading SMS model...';
                const smsModelPromise = tf.loadLayersModel(MODELS.sms.modelPath);
                const smsIndexPromise = loadResource(MODELS.sms.indexPath);

                UI.loadingStatus.textContent = 'Loading URL model...';
                const urlModelPromise = tf.loadLayersModel(MODELS.url.modelPath);
                const urlIndexPromise = loadResource(MODELS.url.indexPath);
                
                UI.loadingStatus.textContent = 'Finalizing initialization...';
                const [smsModel, smsIndex, urlModel, urlIndex] = await Promise.all([
                    smsModelPromise, smsIndexPromise, urlModelPromise, urlIndexPromise
                ]);

                if (!smsModel || !smsIndex || !urlModel || !urlIndex) {
                    throw new Error("One or more critical resources failed to load. Check console for details.");
                }

                MODELS.sms.model = smsModel;
                MODELS.sms.index = smsIndex;
                MODELS.url.model = urlModel;
                MODELS.url.index = urlIndex;

                // Fade out loading screen and fade in main content
                UI.loadingOverlay.classList.add('opacity-0');
                setTimeout(() => UI.loadingOverlay.style.display = 'none', 500);
                UI.mainContent.classList.remove('opacity-0');
                UI.analyzeBtn.disabled = false;

            } catch (error) {
                console.error("Initialization failed:", error);
                UI.loadingStatus.textContent = 'CRITICAL ERROR: Initialization Failed. See console.';
                UI.loadingStatus.classList.add('text-red-500');
            }
        }
        
        function preprocessText(text, index, maxLength, isCharBased = false) {
            let tokens;
            if (isCharBased) {
                tokens = text.toLowerCase().split('');
            } else {
                // Simple whitespace and punctuation tokenizer for SMS
                tokens = text.toLowerCase().replace(/[.,!?;:]/g, ' ').split(/\s+/).filter(Boolean);
            }
            
            const sequence = tokens.map(token => {
                const wordIndex = index[token];
                return wordIndex ? wordIndex : 0; // Use 0 for unknown words/chars (padding token)
            });
            
            // Pad or truncate the sequence
            const paddedSequence = new Array(maxLength).fill(0);
            const start = Math.max(0, maxLength - sequence.length);
            for (let i = 0; i < Math.min(sequence.length, maxLength); i++) {
                paddedSequence[start + i] = sequence[i];
            }
            
            return tf.tensor2d([paddedSequence]);
        }
        
        // --- CORE ANALYSIS LOGIC ---
        async function analyze() {
            const inputText = UI.textInput.value.trim();
            if (!inputText) {
                // Using a custom, non-blocking alert styled modal would be better in a real app
                // but alert is fine for this context.
                alert('Please enter text or a URL to analyze.');
                return;
            }
            
            UI.analyzeBtn.disabled = true;
            UI.analyzeBtn.textContent = 'ANALYZING...';
            UI.resultSection.style.display = 'none';

            // Allow UI to update before heavy computation
            await new Promise(resolve => setTimeout(resolve, 50));

            try {
                const selectedModelKey = document.querySelector('input[name="modelType"]:checked').value;
                const config = MODELS[selectedModelKey];
                
                if (!config.model || !config.index) {
                    throw new Error(`${selectedModelKey.toUpperCase()} model not loaded.`);
                }
                
                const isCharBased = selectedModelKey === 'url';
                const tensor = preprocessText(inputText, config.index, config.maxLength, isCharBased);
                
                const predictionTensor = config.model.predict(tensor);
                const prediction = await predictionTensor.data();
                
                displayResult(prediction[0]);

                tensor.dispose();
                predictionTensor.dispose();

            } catch(error) {
                console.error("Analysis Error:", error);
                alert("An error occurred during analysis. Please check the console.");
            } finally {
                UI.analyzeBtn.disabled = false;
                UI.analyzeBtn.textContent = 'ANALYZE';
            }
        }

        // --- EVENT LISTENERS ---
        document.addEventListener('DOMContentLoaded', initialize);
        UI.analyzeBtn.addEventListener('click', analyze);
        UI.clearBtn.addEventListener('click', clearResult);
    </script>

</body>
</html>
